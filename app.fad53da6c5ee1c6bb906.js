(()=>{"use strict";(()=>{function e(){}function t(e){return e()}function s(){return Object.create(null)}function n(e){e.forEach(t)}function i(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let a;function l(e,t){return a||(a=document.createElement("a")),a.href=t,e===a.href}function r(e){return 0===Object.keys(e).length}function c(e,t,s,n){return e[1]&&n?function(e,t){for(const s in t)e[s]=t[s];return e}(s.ctx.slice(),e[1](n(t))):s.ctx}new Set;let u,d=!1;function h(e,t,s){e.insertBefore(t,s||null)}function p(e){e.parentNode.removeChild(e)}function f(e){return document.createElement(e)}function m(e){return document.createTextNode(e)}function g(){return m(" ")}function y(e,t,s,n){return e.addEventListener(t,s,n),()=>e.removeEventListener(t,s,n)}function v(e,t,s){null==s?e.removeAttribute(t):e.getAttribute(t)!==s&&e.setAttribute(t,s)}function b(e){u=e}function $(){if(!u)throw new Error("Function called outside component initialization");return u}function k(e,t){const s=e.$$.callbacks[t.type];s&&s.slice().forEach((e=>e.call(this,t)))}new Set;const _=[],w=[],M=[],C=[],T=Promise.resolve();let A=!1;function q(e){M.push(e)}let x=!1;const U=new Set;function R(){if(!x){x=!0;do{for(let e=0;e<_.length;e+=1){const t=_[e];b(t),S(t.$$)}for(b(null),_.length=0;w.length;)w.pop()();for(let e=0;e<M.length;e+=1){const t=M[e];U.has(t)||(U.add(t),t())}M.length=0}while(_.length);for(;C.length;)C.pop()();A=!1,x=!1,U.clear()}}function S(e){if(null!==e.fragment){e.update(),n(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(q)}}const E=new Set;let N,I;function H(e,t){e&&e.i&&(E.delete(e),e.i(t))}function P(e,t,s,n){if(e&&e.o){if(E.has(e))return;E.add(e),N.c.push((()=>{E.delete(e),n&&(s&&e.d(1),n())})),e.o(t)}}function j(e,t){const s=t.token={};function i(e,i,o,a){if(t.token!==s)return;t.resolved=a;let l=t.ctx;void 0!==o&&(l=l.slice(),l[o]=a);const r=e&&(t.current=e)(l);let c=!1;t.block&&(t.blocks?t.blocks.forEach(((e,s)=>{s!==i&&e&&(N={r:0,c:[],p:N},P(e,1,1,(()=>{t.blocks[s]===e&&(t.blocks[s]=null)})),N.r||n(N.c),N=N.p)})):t.block.d(1),r.c(),H(r,1),r.m(t.mount(),t.anchor),c=!0),t.block=r,t.blocks&&(t.blocks[i]=r),c&&R()}if((o=e)&&"object"==typeof o&&"function"==typeof o.then){const s=$();if(e.then((e=>{b(s),i(t.then,1,t.value,e),b(null)}),(e=>{if(b(s),i(t.catch,2,t.error,e),b(null),!t.hasCatch)throw e})),t.current!==t.pending)return i(t.pending,0),!0}else{if(t.current!==t.then)return i(t.then,1,t.value,e),!0;t.resolved=e}var o}function z(e,s,o,a){const{fragment:l,on_mount:r,on_destroy:c,after_update:u}=e.$$;l&&l.m(s,o),a||q((()=>{const s=r.map(t).filter(i);c?c.push(...s):n(s),e.$$.on_mount=[]})),u.forEach(q)}function K(e,t){const s=e.$$;null!==s.fragment&&(n(s.on_destroy),s.fragment&&s.fragment.d(t),s.on_destroy=s.fragment=null,s.ctx=[])}function L(t,i,o,a,l,r,c,h=[-1]){const f=u;b(t);const m=t.$$={fragment:null,ctx:null,props:r,update:e,not_equal:l,bound:s(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(f?f.$$.context:[])),callbacks:s(),dirty:h,skip_bound:!1,root:i.target||f.$$.root};c&&c(m.root);let g=!1;if(m.ctx=o?o(t,i.props||{},((e,s,...n)=>{const i=n.length?n[0]:s;return m.ctx&&l(m.ctx[e],m.ctx[e]=i)&&(!m.skip_bound&&m.bound[e]&&m.bound[e](i),g&&function(e,t){-1===e.$$.dirty[0]&&(_.push(e),A||(A=!0,T.then(R)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),s})):[],m.update(),g=!0,n(m.before_update),m.fragment=!!a&&a(m.ctx),i.target){if(i.hydrate){d=!0;const e=(y=i.target,Array.from(y.childNodes));m.fragment&&m.fragment.l(e),e.forEach(p)}else m.fragment&&m.fragment.c();i.intro&&H(t.$$.fragment),z(t,i.target,i.anchor,i.customElement),d=!1,R()}var y;b(f)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(I=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(t).filter(i);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,s){this[e]=s}disconnectedCallback(){n(this.$$.on_disconnect)}$destroy(){K(this,1),this.$destroy=e}$on(e,t){const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const e=s.indexOf(t);-1!==e&&s.splice(e,1)}}$set(e){this.$$set&&!r(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class O{$destroy(){K(this,1),this.$destroy=e}$on(e,t){const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const e=s.indexOf(t);-1!==e&&s.splice(e,1)}}$set(e){this.$$set&&!r(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class B{constructor(e){this.kosyClient=window.parent,this.latestMessageNumber=0,this.kosyApp=e}dictionaryToArray(e){let t=[];for(const s in e)e.hasOwnProperty(s)&&t.push([s,e[s]]);return t}startApp(){return this.initialInfoPromise=new Promise(((e,t)=>{window.addEventListener("message",(t=>{let s=t.data;switch(s.type){case"receive-initial-info":this.latestMessageNumber=s.latestMessageNumber,this.clients=s.payload.clients,this.hostClientUuid=s.payload.initializerClientUuid,this.log("Resolving initial info promise with: ",s.payload),e(s.payload);break;case"set-client-info":{let e=s.clients,t=s.hostClientUuid;this.initialInfoPromise.then((s=>{let n=this.dictionaryToArray(e).filter((e=>!this.clients[e[0]])),i=this.dictionaryToArray(this.clients).filter((t=>!e[t[0]])),o=this.latestMessageNumber;this.hostClientUuid!==t&&this._relayMessageToClients(s,{type:"_host-has-changed",clientUuid:t},++o),n.forEach((e=>this._relayMessageToClients(s,{type:"_client-has-joined",clientInfo:e[1]},++o))),i.forEach((e=>this._relayMessageToClients(s,{type:"_client-has-left",clientUuid:e[0]},++o))),this.clients=e,this.hostClientUuid=t}));break}case"get-app-state":{let e=s.clientUuids;this.log("Get app state received -> sending app state");const t=this.kosyApp.onRequestState();this._sendMessageToKosy({type:"receive-app-state",state:t,clientUuids:e,latestMessageNumber:this.latestMessageNumber});break}case"set-app-state":this.latestMessageNumber=s.latestMessageNumber;let t=s.state;this.initialInfoPromise.then((()=>{this.log("Received app state from Kosy -> setting app state"),this.kosyApp.onProvideState(t)}));break;case"receive-message-as-host":this._handleReceiveMessageAsHost(s);break;case"receive-message-as-client":this._handleReceiveMessageAsClient(s)}})),this._sendMessageToKosy({type:"ready-and-listening"})})),this.initialInfoPromise}stopApp(){this._sendMessageToKosy({type:"stop-app"})}relayMessage(e){this.log("Relaying client message to host: ",e),this._sendMessageToKosy({type:"relay-message-to-host",message:e})}_relayMessageToClients(e,t,s){this.log("Relaying host to client message: ",t),this._sendMessageToKosy({type:"relay-message-to-clients",sentByClientUuid:e.currentClientUuid,message:t,messageNumber:s})}_sendMessageToKosy(e){this.kosyClient.postMessage(e,"*")}_handleReceiveMessageAsClientRecursive(e,t,s){var n,i,o,a,l,r;if(this.latestMessageNumber===e.messageNumber-1){switch(e.message.type){case"_host-has-changed":{let t=e.message.clientUuid;this.hostClientUuid=t,null===(i=(n=this.kosyApp).onHostHasChanged)||void 0===i||i.call(n,t);break}case"_client-has-joined":{let t=e.message.clientInfo;this.clients[t.clientUuid]=t,null===(a=(o=this.kosyApp).onClientHasJoined)||void 0===a||a.call(o,t);break}case"_client-has-left":{let t=e.message.clientUuid;this.clients[t]=null,null===(r=(l=this.kosyApp).onClientHasLeft)||void 0===r||r.call(l,t);break}default:this.kosyApp.onReceiveMessageAsClient(e.message)}this.latestMessageNumber=e.messageNumber}else s<50&&this.latestMessageNumber<e.messageNumber?setTimeout((()=>this._handleReceiveMessageAsClientRecursive(e,t,s+1)),100):(this.log("Timeout on processing message as client: ",e.message),this.log("Wait for Kosy to fix this mess..."))}_handleReceiveMessageAsClient(e){this.initialInfoPromise.then((t=>{this.log("Received message as client, processing: ",e.message),this._handleReceiveMessageAsClientRecursive(e,t,0)}))}_handleReceiveMessageAsHost(e){this.initialInfoPromise.then((t=>{this.log("Trying to handle message as host");const s=this.kosyApp.onReceiveMessageAsHost(e.message);s&&this._relayMessageToClients(t,s,this.latestMessageNumber+1)}))}log(...e){"1"===localStorage.getItem("debug-mode")&&console.log("From kosy-app-api: ",...e)}}function V(e){let t,s,i,o;const a=e[5].default,l=function(e,t,s,n){if(e){const n=c(e,t,s,null);return e[0](n)}}(a,e,e[4]);return{c(){t=f("button"),l&&l.c(),v(t,"class",e[1]),t.disabled=e[0]},m(n,a){h(n,t,a),l&&l.m(t,null),s=!0,i||(o=[y(t,"click",e[6]),y(t,"dblclick",e[7]),y(t,"focus",e[8])],i=!0)},p(e,[n]){l&&l.p&&(!s||16&n)&&function(e,t,s,n,i,o){if(i){const a=c(t,s,n,o);e.p(a,i)}}(l,a,e,e[4],s?function(e,t,s,n){if(e[2]&&n){const i=e[2](n(s));if(void 0===t.dirty)return i;if("object"==typeof i){const e=[],s=Math.max(t.dirty.length,i.length);for(let n=0;n<s;n+=1)e[n]=t.dirty[n]|i[n];return e}return t.dirty|i}return t.dirty}(a,e[4],n,null):function(e){if(e.ctx.length>32){const t=[],s=e.ctx.length/32;for(let e=0;e<s;e++)t[e]=-1;return t}return-1}(e[4]),null),(!s||2&n)&&v(t,"class",e[1]),(!s||1&n)&&(t.disabled=e[0])},i(e){s||(H(l,e),s=!0)},o(e){P(l,e),s=!1},d(e){e&&p(t),l&&l.d(e),i=!1,n(o)}}}function F(e,t,s){let{$$slots:n={},$$scope:i}=t,{size:o="regular"}=t,{importance:a}=t,{disabled:l=!1}=t,r="";return e.$$set=e=>{"size"in e&&s(2,o=e.size),"importance"in e&&s(3,a=e.importance),"disabled"in e&&s(0,l=e.disabled),"$$scope"in e&&s(4,i=e.$$scope)},e.$$.update=()=>{if(12&e.$$.dirty){let e=["re-button","size-"+o];a&&e.push("importance-"+a),s(1,r=e.join(" "))}},[l,r,o,a,i,n,function(t){k.call(this,e,t)},function(t){k.call(this,e,t)},function(t){k.call(this,e,t)}]}const W=class extends O{constructor(e){super(),L(this,e,F,V,o,{size:2,importance:3,disabled:0})}};var G,Q=new Uint8Array(16);function D(){if(!G&&!(G="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return G(Q)}const J=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,X=function(e){return"string"==typeof e&&J.test(e)};for(var Y=[],Z=0;Z<256;++Z)Y.push((Z+256).toString(16).substr(1));const ee=function(e,t,s){var n=(e=e||{}).random||(e.rng||D)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){s=s||0;for(var i=0;i<16;++i)t[s+i]=n[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=(Y[e[t+0]]+Y[e[t+1]]+Y[e[t+2]]+Y[e[t+3]]+"-"+Y[e[t+4]]+Y[e[t+5]]+"-"+Y[e[t+6]]+Y[e[t+7]]+"-"+Y[e[t+8]]+Y[e[t+9]]+"-"+Y[e[t+10]]+Y[e[t+11]]+Y[e[t+12]]+Y[e[t+13]]+Y[e[t+14]]+Y[e[t+15]]).toLowerCase();if(!X(s))throw TypeError("Stringified UUID is invalid");return s}(n)};function te(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function se(e){let t,s,n,i,o,a,r=e[1]&&ne();return o=new W({props:{importance:"secondary",$$slots:{default:[ie]},$$scope:{ctx:e}}}),o.$on("click",e[4]),{c(){var a;t=f("iframe"),n=g(),r&&r.c(),i=g(),(a=o.$$.fragment)&&a.c(),v(t,"title","codenames iframe"),l(t.src,s=e[0].appUrl)||v(t,"src",s),v(t,"class","svelte-q3u30t")},m(e,s){h(e,t,s),h(e,n,s),r&&r.m(e,s),h(e,i,s),z(o,e,s),a=!0},p(e,n){(!a||1&n&&!l(t.src,s=e[0].appUrl))&&v(t,"src",s),e[1]?r||(r=ne(),r.c(),r.m(i.parentNode,i)):r&&(r.d(1),r=null);const c={};512&n&&(c.$$scope={dirty:n,ctx:e}),o.$set(c)},i(e){a||(H(o.$$.fragment,e),a=!0)},o(e){P(o.$$.fragment,e),a=!1},d(e){e&&p(t),e&&p(n),r&&r.d(e),e&&p(i),K(o,e)}}}function ne(e){let t;return{c(){t=f("div"),t.innerHTML='<div class="svelte-q3u30t"><h3 class="svelte-q3u30t">What is the goal?</h3> \n                    <ol class="svelte-q3u30t"><li class="svelte-q3u30t">Players split into 2 teams: Blue &amp; Red, with each team assigning a Spymaster. The rest of the team are Field Operatives.</li> \n                        <li class="svelte-q3u30t">The Spymasters go in Spymaster mode in the bottom right corner. Spymasters of each team can check agents’ team color, hiding behind the codenames.</li> \n                        <li class="svelte-q3u30t">Spymasters must guide each team to guess the codenames of their team’s agents by providing a clue to them.</li> \n                        <li class="svelte-q3u30t">Teams use the clue to guess the right codenames related to their team’s agents</li> \n                        <li class="svelte-q3u30t">Winning team is the team that uncovers the identities of all their agents</li></ol> \n                    <h3 class="svelte-q3u30t">Gameplay</h3> \n                    <span>Teams take turns to do the following:</span> \n                    <ol class="svelte-q3u30t"><li class="svelte-q3u30t">The team’s Spymaster gives clues:\n                            <ol class="svelte-q3u30t"><li class="svelte-q3u30t">Spymaster selects the codenames he/she would like the field operatives to uncover</li> \n                                <li class="svelte-q3u30t">Spymaster gives a one-word clue and shouts out the number of codenames it relates to. This number will indicate the number of correct guesses the team can make for the turn. If the team makes a correct guess form previous clue, they are allowed 1 extra guess</li></ol></li> \n                        <li class="svelte-q3u30t">Team’s field operatives guess the codenames to uncover:\n                            <ol class="svelte-q3u30t"><li class="svelte-q3u30t">Teammates discuss the clue and make a guess by touching one of the codenames on the table</li> \n                                <li class="svelte-q3u30t">If it uncovers an agent belonging to the team, they continue guessing until they uncover all codenames related to the clue</li> \n                                <li class="svelte-q3u30t">The turn is passed to the next team, if any of the guesses are wrong</li></ol></li> \n                        <li class="svelte-q3u30t">Both teams lose if they uncover an Assassin card.</li></ol></div>',v(t,"class","pop-up svelte-q3u30t")},m(e,s){h(e,t,s)},d(e){e&&p(t)}}}function ie(e){let t,s,n;return{c(){t=f("img"),n=m("\n            How to play"),v(t,"class","icon-left"),l(t.src,s="assets/Question-icon.png")||v(t,"src","assets/Question-icon.png"),v(t,"alt","question-mark")},m(e,s){h(e,t,s),h(e,n,s)},d(e){e&&p(t),e&&p(n)}}}function oe(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function ae(e){let t,s,n,i={ctx:e,current:null,token:null,hasCatch:!1,pending:oe,then:se,catch:te,value:8,blocks:[,,,]};return j(s=e[2],i),{c(){t=f("main"),i.block.c(),v(t,"class","svelte-q3u30t")},m(e,s){h(e,t,s),i.block.m(t,i.anchor=null),i.mount=()=>t,i.anchor=null,n=!0},p(t,[s]){!function(e,t,s){const n=t.slice(),{resolved:i}=e;e.current===e.then&&(n[e.value]=i),e.current===e.catch&&(n[e.error]=i),e.block.p(n,s)}(i,e=t,s)},i(e){n||(H(i.block),n=!0)},o(e){for(let e=0;e<3;e+=1)P(i.blocks[e]);n=!1},d(e){e&&p(t),i.block.d(),i.token=null,i=null}}}function le(e,t,s){let n={appUrl:null},i=!1,o=e=>{if(null==e?void 0:e.appUrl){let t=e.appUrl.split("#")[0];s(0,n={appUrl:t}),setTimeout((()=>s(0,n={appUrl:t+"#end-turn-btn"})),1e3)}};const a=new B({onReceiveMessageAsHost:e=>e,onReceiveMessageAsClient:e=>{"receive-codenames-url"===e.type&&o({appUrl:e.payload})},onRequestState:()=>n,onProvideState:e=>o(e)});let l=a.startApp().then((e=>{e.currentClientUuid==e.initializerClientUuid&&setTimeout((()=>a.relayMessage({type:"receive-codenames-url",payload:`https://www.horsepaste.com/${e.locationUuid}_${ee()}`})),500),o(e.currentAppState)}));const r=()=>s(1,i=!i);return[n,i,l,r,()=>r()]}new class extends O{constructor(e){super(),L(this,e,le,ae,o,{})}}({target:document.getElementById("container"),props:{}})})()})();